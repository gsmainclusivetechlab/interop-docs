(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{120:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return b})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return p}));var n=a(2),o=a(6),i=(a(0),a(151)),s=a(213),r={id:"howtestswork",title:"How Tests Work with Components",sidebar_label:"How Tests Work"},b={id:"howtestswork",title:"How Tests Work with Components",description:"This page describes how the various components of the Interoperability Testing",source:"@site/docs/howtestswork.mdx",permalink:"/howtestswork",editUrl:"https://github.com/gsmainclusivetechlab/interop-docs/docs/howtestswork.mdx",sidebar_label:"How Tests Work",sidebar:"someSidebar",previous:{title:"ITP Architecture",permalink:"/architecture"},next:{title:"Interoperability Test Platform Installation Guide",permalink:"/installitp"}},l=[{value:"Components",id:"components",children:[]},{value:"Connections between Components",id:"connections-between-components",children:[]},{value:"Component URLs",id:"component-urls",children:[{value:"SUT URLs",id:"sut-urls",children:[]},{value:"TODO: Do we need the simulator URL documentation here?",id:"todo-do-we-need-the-simulator-url-documentation-here",children:[]}]},{value:"Test Step Matching",id:"test-step-matching",children:[{value:"Simulator URLs",id:"simulator-urls",children:[]}]},{value:"TODO:",id:"todo",children:[]}],c={rightToc:l};function p(e){var t=e.components,a=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"This page describes how the various components of the Interoperability Testing\nPlatform (ITP) work together, and how they can be deployed to different\nenvironments."),Object(i.b)("h2",{id:"components"},"Components"),Object(i.b)("p",null,"There are five main components used to test the paths corresponding to different\nuse cases. They are:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"SP Simulator"),": Acts as a mock service provider (SP) such as a utilities\ncompany or supermarket checkout to simulate their role in a transaction."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"MMO1 simulator"),": Acts as a mock financial services provider (FSP)\nrepresenting the ",Object(i.b)("em",{parentName:"li"},"payee")," of a transaction."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"MMO1 simulator"),": Acts as a mock financial services provider (FSP)\nrepresenting the ",Object(i.b)("em",{parentName:"li"},"payer")," of a transaction."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Mojaloop Simulator"),": Acts as an interoperability platform that connects\nMMO1 and MMO2 in a transaction."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Interoperability Test Platform"),": The core test platform which intercepts\nall messages between the components to display them and validate component\nbehaviours.")),Object(i.b)("h2",{id:"connections-between-components"},"Connections between Components"),Object(i.b)("p",null,"In normal operation, the payer's MMO would connect directly to Mojaloop to\narrange a funds transfer to the payee's MMO. In testing, however, we must\ninspect every message to validate that they are correctly formed. To achieve\nthis, the ITP acts as a transparent proxy between all components. By configuring\nendpoint URLs within component A to point at the ITP instead of directly to\ncomponent B, the ITP can store all messages and forward them onto component B."),Object(i.b)(s.a,{options:{height:"auto"},dot:'\n    digraph { \n      rankdir="TD"\n      ratio="fill";\n      size="6,2";\n      sp [ label="SP" shape="box"]\n      mmo1 [ label="MMO1" shape="box"]\n      mojaloop [ label="Mojaloop" shape="box"]\n      mmo2 [ label="MMO2" shape="box"]\n      ITP [ label="Test Platform" shape="box"]\n      subgraph sim {\n        rank="same"\n        sp -> mmo1 -> sp [ style="dashed", color="#67ab9f"] \n        mmo1 -> mojaloop -> mmo2 -> mojaloop -> mmo1 [ style="dashed", nodesep=1]\n      }\n      ITP -> {sp mmo1} [dir="both", color="#67ab9f"]\n      ITP -> {mmo1 mojaloop mmo2} [dir="both"]\n    }\n',mdxType:"Graphviz"}),Object(i.b)(s.a,{options:{height:"auto"},dot:'\n      digraph {\n        size="6,2";\n        rankdir="LR"\n        a [style=invis];\n        b [style=invis] ;\n        c [style=invis] ;\n        d [style=invis] ;\n        e [style=invis] ;\n        f [style=invis] ;\n        a -> b [label="Actual message (MM API)", color="#67ab9f"] ;\n        b -> f [label="Actual message (Mojaloop API)"] ;\n        c -> d [label="Logical message (MM API)", style=dashed, color="#67ab9f"];\n        d -> e [label="Logical message (Mojaloop API)", style=dashed] ; \n      }        \n',mdxType:"Graphviz"}),Object(i.b)("h2",{id:"component-urls"},"Component URLs"),Object(i.b)("p",null,"In order to recognise the sender and intended recipient of each message received\nby the test platform, this information must be embedded within the message.\nSpecifically, the test platform expects that the base URL for each request will\ncontain a UUID corresponding to both the sender and intended recipients of the\nmessage. Normally, the test platform will insert these UUIDs transparently so\nthat it is not necessary to know which component corresponds to which UUID, but\nit can be helpful for debugging to know which UUID is which:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"SP"),": 114511be-74e9-49d5-b93e-b4a461e01626"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"MMO1"),": e5f5e817-94d6-4a43-a7ec-f7274b6d85c2"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Mojaloop"),": b2a85076-b748-4d93-8df1-2b39844e6d4b"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"MMO2"),": e602a859-a25f-4d37-9abe-0ac09fb734af")),Object(i.b)("h3",{id:"sut-urls"},"SUT URLs"),Object(i.b)("p",null,"Within a SUT, the base URL of each component should be configured according to\nthe following scheme:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"https://{itp_url}/testing/{session_uuid}/{my_uuid}/{recipient_uuid}/sut/\n")),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"session_uuid")," corresponds to a unique ID for each testing session, and\nhelps the test platform to validate incoming messages to ensure that the\nexpected test-cases are being correctly matched. ",Object(i.b)("inlineCode",{parentName:"p"},"itp_url")," is the base URL of\nthe test platform (e.g. ",Object(i.b)("inlineCode",{parentName:"p"},"interop.gsmainclusivetechlab.io"),"). ",Object(i.b)("inlineCode",{parentName:"p"},"my_uuid")," is the\nUUID of the component which is being tested, and ",Object(i.b)("inlineCode",{parentName:"p"},"recipient_uuid")," is the UUID of\nthe component to which the request will be made."),Object(i.b)("p",null,"Thus, the URL that an MMO1 test subject should use to send messages to Mojaloop\n(through the test platform) would be:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"https://interop.gsmainclusivetechlab.io/testing/41a2e8d5-3ce4-459b-a6eb-1a1e2988c357/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/b2a85076-b748-4d93-8df1-2b39844e6d4b/sut/\n")),Object(i.b)("h3",{id:"todo-do-we-need-the-simulator-url-documentation-here"},"TODO: Do we need the simulator URL documentation here?"),Object(i.b)("p",null,"It feels like it's not useful for a normal user who wouldn't be configuring the\nsimulators anyway. It might be useful in a separate \"deployment\" guide."),Object(i.b)("h2",{id:"test-step-matching"},"Test Step Matching"),Object(i.b)("p",null,"Using the URLs configured above, "),Object(i.b)("h3",{id:"simulator-urls"},"Simulator URLs"),Object(i.b)("p",null,"Since the simulators are within the control of the test platform, we can\nslightly simplify the request URLs compared to SUTs. In particular, the\nsimulators use a ",Object(i.b)("inlineCode",{parentName:"p"},"traceparent")," header in place of the ",Object(i.b)("inlineCode",{parentName:"p"},"session_uuid")," from above.\nFor this reason base URLs used by each simulator have this structure."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"https://{itp_url}/testing/{my_uuid}/{recipient_uuid}/simulator/\n")),Object(i.b)("p",null,"Thus, the URL that an MMO1 simulator should use to send messages to Mojaloop\n(through the test platform) would be:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"https://interop.gsmainclusivetechlab.io/testing/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/b2a85076-b748-4d93-8df1-2b39844e6d4b/simulator/\n")),Object(i.b)("h2",{id:"todo"},"TODO:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"test triggers"),Object(i.b)("li",{parentName:"ul"},"configuring env for simulators"),Object(i.b)("li",{parentName:"ul"},"configuring callbacks for mojaloop")),Object(i.b)("p",null,"1.3.4) Mojaloop specifics Mojaloop should also send messages to Test Control,\ninstead of sending them to simulators/SUTs. This is being managed via FSP\ncallbacks inside Mojaloop. More about the initial callbacks setup you can find\nhere. There are 2 FSPs (for MMO1 and MMO2) that need to be setup per environment\n(e.g. Production or Staging)."),Object(i.b)("p",null,"The URL structure for callbacks is a very similar to simulators\u2019 one:"),Object(i.b)("p",null,"http://{itp_url}/testing/{mojaloop_uuid}/{recipient_uuid}/simulator/{path},\nwhere"),Object(i.b)("p",null,"{itp_url} is a URL of ITP,",Object(i.b)("br",{parentName:"p"}),"\n","e.g. ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io"}),"http://interop.gsmainclusivetechlab.io")," testing is an identification for\nTest Control that this URL is related to Test Cases flow {mojaloop_uuid} is uuid\nof this simulator e.g. b2a85076-b748-4d93-8df1-2b39844e6d4b {recipient_uuid} is\na uuid of simulator that I send a message to e.g. for MMO1\ne5f5e817-94d6-4a43-a7ec-f7274b6d85c2 simulator is an identification for Test\nControl that this URL is related Simulator, so it includes a traceparent and its\nmessages can be overridden {path} the pass that is necessary to execute exact\ncallback"),Object(i.b)("p",null,"Below you can find some examples of callbacks in Mojaloop that were set for\nMMO1:"),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_TRX_REQ_SERVICE\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_QUOTES\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_TRANSFER_POST\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_TRANSFER_PUT\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers/%7B%7BtransferId%7D%7D"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers/{{transferId}}")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_TRANSFER_ERROR\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers/%7B%7BtransferId%7D%7D/error"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/transfers/{{transferId}}/error")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_AUTHORIZATIONS\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_PARTICIPANT_PUT\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/participants/%7B%7BpartyIdType%7D%7D/%7B%7BpartyIdentifier%7D%7D"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/participants/{{partyIdType}}/{{partyIdentifier}}")),Object(i.b)("p",null,"FSPIOP_CALLBACK_URL_PARTICIPANT_PUT_ERROR\n",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/participants/%7B%7BpartyIdType%7D%7D/%7B%7BpartyIdentifier%7D%7D/error"}),"http://interop.gsmainclusivetechlab.io/testing/b2a85076-b748-4d93-8df1-2b39844e6d4b/e5f5e817-94d6-4a43-a7ec-f7274b6d85c2/simulator/participants/{{partyIdType}}/{{partyIdentifier}}/error")))}p.isMDXComponent=!0},201:function(e,t){},202:function(e,t){},221:function(e,t){}}]);